function remove_location(e){if(total_locations>1){var t,o,n,a,l,r,i,s,c;for(location_counter=e;location_counter<total_locations;location_counter++)for(c=location_counter+1,row=0;row<=7;row++)l="Location_"+location_counter+"_"+input_rows[row],r="Location_"+c+"_"+input_rows[row],i=document.getElementById(l),s=document.getElementById(r),i.value=s.value;for(row=0;row<all_rows.length;row++)t=all_rows[row]+"TR",n="Location_"+total_locations+"_"+all_rows[row]+"TD",o=document.getElementById(t),a=document.getElementById(n),o.removeChild(a);total_locations-=1;var d=document.getElementById("TotalLocationsTD");if(d.innerHTML="Total Locations: "+total_locations,1==total_locations){location_1_td_element=document.getElementById("Location_1_RemoveButtonTD");var u=document.createElement("button");$(u).addClass("btn btn-default btn-xs btn-transparent"),u.innerHTML="&nbsp;",u.addEventListener("click",remove_location_1),"undefined"!==location_1_td_element.childNodes[0]&&location_1_td_element.removeChild(location_1_td_element.childNodes[0]),location_1_td_element.appendChild(u)}}}function add_location(){if(5>total_locations){total_locations+=1,2==total_locations&&(location_1_td_element=document.getElementById("Location_1_RemoveButtonTD"),b=document.createElement("button"),$(b).addClass("btn btn-default btn-xs"),b.innerHTML="Remove",b.addEventListener("click",remove_location_1),location_1_td_element.removeChild(location_1_td_element.childNodes[0]),location_1_td_element.appendChild(b));var e,t,o,n,a="",l="",r="",i="";for(row=0;row<all_rows.length;row++)a=all_rows[row]+"TR",l="Location_"+total_locations+"_"+all_rows[row]+"TD",r="Overall_"+all_rows[row]+"TD",e=document.createElement("td"),$(e).addClass("inputTD"),e.id=l,o=document.getElementById(a),n=document.getElementById(r),o.insertBefore(e,n);var s=document.getElementById("TotalLocationsTD");for(s.innerHTML="Total Locations: "+total_locations,row=0;row<input_rows.length;row++)a=input_rows[row]+"TR",l="Location_"+total_locations+"_"+input_rows[row]+"TD",r="Overall_"+input_rows[row]+"TD",i="Location_"+total_locations+"_"+input_rows[row],e=document.getElementById(l),t=document.createElement("input"),t.type="text",t.size="6",t.name=i,t.id=i,e.appendChild(t);l="Location_"+total_locations+"_TitleTD";var c=document.getElementById(l),d=document.createTextNode("Location "+total_locations);c.appendChild(d);var u=document.getElementById("TitleTR"),m=document.getElementById("Overall_TitleTD");u.insertBefore(c,m),l="Location_"+total_locations+"_RemoveButtonTD";var _=document.getElementById(l),b=document.createElement("button");switch($(b).addClass("btn btn-default btn-xs"),b.innerHTML="Remove",total_locations){case 2:b.addEventListener("click",remove_location_2);break;case 3:b.addEventListener("click",remove_location_3);break;case 4:b.addEventListener("click",remove_location_4);break;case 5:b.addEventListener("click",remove_location_5)}_.appendChild(b)}}function remove_location_1(){remove_location(1)}function remove_location_2(){remove_location(2)}function remove_location_3(){remove_location(3)}function remove_location_4(){remove_location(4)}function remove_location_5(){remove_location(5)}function insert_rows(){var e,t,o,n,a,l,r,i,s,c,d,u,m,_,b=document.getElementById("secondTable");for(row=0;row<all_rows.length;row++)t=all_rows[row]+"TR",n=all_rows[row]+"LabelTD",i="Location_1_"+all_rows[row]+"TD",c="Overall_"+all_rows[row]+"TD",e=document.createElement("tr"),e.id=t,o=document.createElement("td"),o.id=n,""!=input_tooltips[row]?(a=document.createElement("A"),a.setAttribute("class","tooltip-show"),a.setAttribute("data-toggle","tooltip"),a.setAttribute("title",input_tooltips[row]),a.setAttribute("tabindex",-1),a.innerHTML=row_labels[row],o.appendChild(a)):(l=document.createTextNode(row_labels[row]),o.appendChild(l)),e.appendChild(o),r=document.createElement("td"),$(r).addClass("inputTD"),r.id=i,e.appendChild(r),s=document.createElement("td"),s.id=c,e.appendChild(s),b.appendChild(e);var p=document.getElementById("CalculateButtonLabelTD");for(p.innerHTML='<button type="button" id="calculate-button" class="btn success btn-default btn-calculate" onclick="update_values()" style="width: 90%; padding: 4px; ">Calculate</button>',row=0;row<input_rows.length;row++)i="Location_1_"+input_rows[row]+"TD",r=document.getElementById(i),d="Location_1_"+input_rows[row],0==row?(up_boxlabel="calculate-button",left_boxlabel="calculate-button"):(up_boxlabel="Location_1_"+input_rows[row-1],left_boxlabel="Location_1_"+input_rows[row-1]),row==input_rows.length-1?(down_boxlabel=d,right_boxlabel=d):(down_boxlabel="Location_1_"+input_rows[row+1],right_boxlabel="Location_1_"+input_rows[row+1]),u=document.createElement("input"),u.type="text",u.size="6",u.name=d,u.id=d,u.setAttribute("upboxlabel",up_boxlabel),u.setAttribute("leftboxlabel",left_boxlabel),u.setAttribute("rightboxlabel",right_boxlabel),u.setAttribute("downboxlabel",down_boxlabel),u.onkeyup=function(e){switch(uplabel=this.getAttribute("upboxlabel"),leftlabel=this.getAttribute("leftboxlabel"),rightlabel=this.getAttribute("rightboxlabel"),downlabel=this.getAttribute("downboxlabel"),e.keyCode){case 9:e.shiftKey?document.getElementById(leftlabel).focus():document.getElementById(rightlabel).focus();break;case 37:document.getElementById(leftlabel).focus();break;case 38:document.getElementById(uplabel).focus();break;case 39:document.getElementById(rightlabel).focus();break;case 40:document.getElementById(downlabel).focus()}},u.onkeydown=function(e){9==e.keyCode&&e.preventDefault()},r.appendChild(u);r=document.getElementById("Location_1_RemoveButtonTD"),m=document.createElement("button"),$(m).addClass("btn btn-default btn-xs btn-transparent"),m.innerHTML="&nbsp;",m.setAttribute("tabindex",-1),r.appendChild(m),r=document.getElementById("Location_1_TitleTD"),_=document.createTextNode("Location 1"),r.appendChild(_),s=document.getElementById("Overall_TitleTD"),_=document.createTextNode("Overall"),s.appendChild(_)}function update_values(){var e,t,o,n,a="Total_Locations="+total_locations;for(row=0;row<input_rows.length;row++)for(this_location=1;this_location<=total_locations;this_location++)if(e="Location_"+this_location+"_"+input_rows[row],t=document.getElementById(e),NaN!=Number(t.value))switch(input_rows[row]){case"Turnover":n=t.value/100,a=a+"&Location_"+this_location+"_"+input_rows[row]+"="+n;break;case"Revenue":n=1e6*t.value,a=a+"&Location_"+this_location+"_"+input_rows[row]+"="+n;break;default:a=a+"&Location_"+this_location+"_"+input_rows[row]+"="+t.value}o=new XMLHttpRequest,o.onreadystatechange=function(){var e,t,n,a,l,r,i,s,c,d;if(4==o.readyState&&200==o.status){var u=o.responseXML;for(row=0;row<all_rows.length;row++)if("Title"!=all_rows[row]&&"RemoveButton"!=all_rows[row]&&"CalculateButton"!=all_rows[row]){switch(n="Overall_"+all_rows[row]+"TD",e=u.getElementsByTagName(all_rows[row])[0],t=e.getElementsByTagName("Overall")[0],"undefined"==typeof t.childNodes[0]?cellvalue="":cellvalue=t.childNodes[0].nodeValue,all_rows[row]){case"Employment":case"CurrentHires":case"DesiredHires":cellvalue=addCommas(Math.floor(cellvalue));break;case"Turnover":case"DesiredQuits":case"CurrentSeatTurnover":case"DesiredSeatTurnover":case"CurrentUnproductive":case"DesiredUnproductive":case"Reduction":cellvalue=addCommas(Math.floor(1e3*cellvalue)/10)+"%";break;case"Vacancy":case"Training":cellvalue=addCommas(Math.floor(10*cellvalue)/10);break;case"Revenue":case"CurrentTCosts":case"CurrentVCosts":case"DesiredTCosts":case"DesiredVCosts":case"Savings":cellvalue="$"+addCommas(.1*Math.floor(cellvalue)/1e5)+" M";break;case"OnboardingCost":case"TrainingCost":case"Compensation":cellvalue="$"+addCommas(Math.floor(cellvalue));break;default:cellvalue=addCommas(Math.floor(10*cellvalue)/10)}a=document.getElementById(n),a.innerHTML=cellvalue}for(var m=0,_=0;0==_;)l=u.getElementsByTagName("datapoint")[m],null!=l?(r=l.getElementsByTagName("reduction")[0],"undefined"==typeof r.childNodes[0]?i="obsnodenull ":(i=r.childNodes[0].nodeValue,r=l.getElementsByTagName("savings")[0],"undefined"==typeof r.childNodes[0]?s="outputnodenull ":(s=r.childNodes[0].nodeValue,d=String(.1*Math.floor(s/1e5)),c=d.indexOf("."),c>=0&&(d=d.substring(0,c+2)),savings[i]=Number(d))),m++):_=1;var b=[];for(var m in savings)b.push({x:m,y:parseFloat(savings[m])});var p={values:b,key:"Annual Impact (M$)",color:"#458258"};savingsData=[],savingsData.push(p),savingsData.sort(),$("#ChartTD").html('<div id="chart"><svg></svg></div>'),d3.select("#chart svg").datum(savingsData).call(chart),nv.utils.windowResize(chart.update),$(".tick").each(function(){$(this).css("opacity","0.5"),console.log("Opacity: "+$(this).css("opacity"))}),$("#calculatorResults")[0].scrollIntoView(!1)}},o.open("POST","js/turnover_calculator.php"),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.send(a)}function addCommas(e){if(null==e)return null;if(e.toString().length<=3)return e.toString();var t="",o=e.toString().length-3,n=e.toString().indexOf(".");n>=0&&(t=e.toString().substring(n),o=n-3);for(var a=o;a>1||a>=1&&"-"!==e.toString().substring(0,1);a-=3)t=","+e.toString().substring(a,a+3)+t;return t=e.toString().substring(0,a+3)+t}var savingsData=[],chart;nv.addGraph(function(){var e=400;chart=nv.models.lineChart().margin({left:50,bottom:50}).useInteractiveGuideline(!0).showLegend(!1).transitionDuration(350).showYAxis(!0).showXAxis(!0);d3.format("d"),d3.scale.linear().domain([0,100]).range([.01,e]);return chart.yAxis.axisLabel("Annual Impact ($M USD)").tickFormat(d3.format(",")).axisLabelDistance(25),chart.margin({left:60}),chart.xAxis.axisLabel("Percent Decrease in Turnover (%)").tickFormat(d3.format(",r")).tickValues([0,10,25,50,75,100]).axisLabelDistance(25),chart.xAxis.scale().domain([0,100]),chart.forceX([0,100]),chart});var total_locations=1,input_rows=["Employment","Turnover","Vacancy","Training","OnboardingCost","TrainingCost","Compensation","Revenue"],input_tooltips=["","","Total number of employees in a typical month, excluding executives. Note that this number is not expected to change as a result of turnover reduction.","Average annual employee turnover rate; for every 100 new hires the number that exits the company within the first 365 days of employment","After an employee leaves, average number of weeks the seat is vacant before a replacement employee is hired.","Average number of training weeks; alternatively, the number of weeks a new hire is unproductive or non-billable ","Total costs per hire associated with onboarding a new employee includes recruiting, testing, onboarding paperwork, interview and other assessment resources, including costs for candidates not hired.","Total cost associated with training a new hire. Excludes cost of employee time; also excludes trainee's use of space and equipment that are normally used during his/her regular employment, but  includes direct and indirect expenses such as time cost for managers and trainers, as well as extra space and equipment that are used exclusively for training.","Average compensation cost per employee per year, including regular and overtime pay; benefits; bonuses; in-kind allowances; payroll and other overhead taxes. Should be calculated in a consistent manner across locations and converted into US dollars if necessary.","Total annual gross revenue from operations minus cost of materials and purchased services"],all_rows=["Title","RemoveButton","Employment","Turnover","Vacancy","Training","OnboardingCost","TrainingCost","Compensation","Revenue","CalculateButton"],row_labels=["Location","","Total&nbsp;Employees","Current&nbsp;Quit&nbsp;Rate&nbsp;(%)","Weeks&nbsp;Vacancy","Weeks&nbsp;Training","Onboard Cost&nbsp;(USD)","Training Cost&nbsp;(USD)","Compensation&nbsp;(USD)","Value&nbsp;Added&nbsp;(M&nbsp;USD)",""],savings=[],finalSavings=[];